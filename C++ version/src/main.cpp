#include <QApplication>
#include <QFormLayout>
#include <QPushButton>
#include <QLineEdit>
#include <QDialog>
#include <QLabel>
#include <QMovie>

class MainWindow : public QDialog
{
public:
    MainWindow()
    {
        QGridLayout *mainLayout = new QGridLayout(this);
        QFormLayout *formLayout = new QFormLayout;

        QPushButton *thanksButton = new QPushButton("Th-thanks");
        QLineEdit *securityCodeLine = new QLineEdit;
        QLineEdit *cardNumberLine = new QLineEdit;
        QLineEdit *expiryDateLine = new QLineEdit;
        QMovie *gif = new QMovie(":/gif");
        QLabel *gifLabel = new QLabel;

        connect(thanksButton, &QPushButton::clicked,
                qApp, [securityCodeLine, cardNumberLine, expiryDateLine]()
                {
                    if (securityCodeLine->text().trimmed().length() +
                            cardNumberLine->text().trimmed().length() +
                            expiryDateLine->text().trimmed().length() ==
                        27)
                    {
                        qApp->exit();
                    }
                });

        thanksButton->setSizePolicy(QSizePolicy::Maximum, QSizePolicy::Maximum);
        cardNumberLine->setInputMask("9999\\/9999\\/9999\\/9999");
        securityCodeLine->setFont(QFont("Consolas"));
        cardNumberLine->setFont(securityCodeLine->font());
        expiryDateLine->setFont(securityCodeLine->font());
        expiryDateLine->setInputMask("99\\/99");
        securityCodeLine->setInputMask("999");
        gifLabel->setMovie(gif);

        mainLayout->addWidget(gifLabel, 0, 0, 3, 1);
        mainLayout->addWidget(new QLabel("<center><b>H-hi there...<br>"
                                         "Do you th-think I could have your<br>"
                                         "credit card information, p-please?</b></center>"),
                              0, 1, 1, 3);
        mainLayout->addLayout(formLayout, 1, 1, 1, 3);
        mainLayout->addWidget(thanksButton, 2, 1, 1, 3, Qt::AlignCenter);

        formLayout->addRow("Card number:", cardNumberLine);
        formLayout->addRow("Expiry date:", expiryDateLine);
        formLayout->addRow("Security code:", securityCodeLine);

        gif->start();
        setFixedSize(sizeHint());
        show();
    }
};

int main(int argc, char **argv)
{
    QApplication app(argc, argv);
    app.setStyle("Fusion");

    MainWindow mainWindow;

    return app.exec();
}
